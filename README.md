# Прогназирование давления в дыхательных путях.

### Описание проекта    
Создание модели для предсказания давления в лёгких пациента, подключенного к ИВЛ. 


### Какой кейс решаем?    
В партнерстве с Принстонским университетом команда Google Brain стремится расширить сообщество вокруг машинного обучения для управления механической вентиляцией. Они считают, что машинное обучение может лучше обобщать легкие с различными характеристиками, что поможет в разработке и эксплуатации аппаратов ИВЛ.


### Краткая информация о данных
Предоставлены данные о 6036000 записей с имитированного вентилятора, подключенного к лёгким. Среди данных:

* id - идентификатор временного шага для всего файла.
* breath_id - идентификатор испытуемого лёгкого.
* R - атрибут легких, указывающий, насколько ограничены дыхательные пути (в cmH2O/L/S). Физически это изменение давления на изменение расхода воздуха (объем воздуха за время). Образно можно представить себе надувание воздушного шара через соломинку - мы можем изменить R, изменив диаметр соломинки, при этом чем выше R, тем труднее надувать шар. 
* C - атрибут легкого, указывающий, насколько легкое податливо (в мл/смH2O). Физически это изменение объема на изменение давления. Образно можно представить тот же пример с воздушным шаром. Мы можем изменить C, изменив толщину латекса воздушного шара, при этом чем выше C, тем тоньше латекс, и его легче надувать.
* time_step - отметка времени.
* u_in - управляющий вход электромагнитного клапана вдоха.
* u_out - управляющий вход для исследовательского электромагнитного клапана.
* pressure - Целевая переменная. Давление в дыхательных путях, измеренное в дыхательном контуре, измеренное в смH2O.

### Этапы работы над проектом  
1. Постановка задачи
2. Знакомство с данными, базовый анализ
3. Разведывательный анализ
4. Подготовка данных
5. Машинное обучение
6. Сериализация модели и подготовка пайплайна
7. Результаты

### Результаты:  
* В данном проекте было получено 6036000 записей о работе вентилятора для лёгких. Данные были подробно изучены - в них присутствуют 75450 временных рядов для разных типов лёгких и разных воздествий на них. 
* Сами данные качествено подготовлены - не обаружено пропусков или выбросов. Так что в качестве предобработки данных были удалены неинформативные признаки и произведена нормализация данных. 
* Были испробованы следующие модели машинного обучения(оценка качества - MAE):

    * Линейная регрессия с параметрами по умолчанию - MAE = 3.944
    * Линейная регрессия, но обученная на полиномиальных признаках 2-ой степени - MAE = 3.137
    * Дерево решений с подобраной оптимальной глубиной - MAE = 1.906
    * Случайный лес с оптимизированными гиперпараметрами - MAE = 1.844
    * Экстремальный градиентный бустинг - MAE = 1.893
    * Нейронная сеть с тремя слоями обучения - MAE = 2.076
#
* Лучший результат показала модель случайного леса, но обучение этой модели заняло очень много времени. Модель экстремального бустинга показала результат несильно хуже, но время обучения гораздно меньше. Выбор был сделан в пользу большей точности, так что для дальшейшего продакшана модели был использован имеено случайный лес.
* Для наглядности был построен предсказанный временной ряд давления и сравнен с исходными данными. Модель показала неплохую предсказательную способность. 
* Модель была сериализована для дальнейшего использования, а ход решения для удобства обёрнут в пайплайн. 

